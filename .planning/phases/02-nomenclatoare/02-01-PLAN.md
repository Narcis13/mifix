---
phase: 02-nomenclatoare
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/server/package.json
  - packages/client/package.json
  - packages/server/src/validation/schemas.ts
  - packages/client/src/components/ui/table.tsx
  - packages/client/src/components/ui/dialog.tsx
  - packages/client/src/components/ui/form.tsx
  - packages/client/src/components/ui/input.tsx
  - packages/client/src/components/ui/select.tsx
  - packages/client/src/components/ui/label.tsx
  - packages/client/src/components/ui/textarea.tsx
  - packages/client/src/components/data-table/DataTable.tsx
  - packages/client/src/lib/api.ts
  - packages/client/src/App.tsx
  - packages/client/src/main.tsx
autonomous: true

must_haves:
  truths:
    - "Client app has navigation between nomenclator pages"
    - "Reusable DataTable component renders tabular data with sorting"
    - "API client functions exist for GET/POST/PUT/DELETE operations"
    - "Zod schemas generated from Drizzle schema for API validation"
  artifacts:
    - path: "packages/server/src/validation/schemas.ts"
      provides: "Zod validation schemas from Drizzle"
      exports: ["insertGestiuneSchema", "insertLocFolosintaSchema", "insertSursaFinantareSchema", "insertContSchema"]
    - path: "packages/client/src/components/data-table/DataTable.tsx"
      provides: "Reusable table component"
      min_lines: 50
    - path: "packages/client/src/lib/api.ts"
      provides: "API client utilities"
      exports: ["api", "fetchApi"]
  key_links:
    - from: "packages/client/src/main.tsx"
      to: "react-router-dom"
      via: "RouterProvider"
      pattern: "RouterProvider|createBrowserRouter"
    - from: "packages/server/src/validation/schemas.ts"
      to: "packages/server/src/db/schema.ts"
      via: "drizzle-zod"
      pattern: "createInsertSchema"
---

<objective>
Set up all dependencies, shadcn/ui components, routing, and reusable patterns for the nomenclatoare phase.

Purpose: Establish the foundation that all CRUD implementations will use - consistent patterns reduce per-feature effort and ensure uniformity.
Output: Working routing between placeholder pages, DataTable component, API client, Zod schemas.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-nomenclatoare/02-RESEARCH.md

@packages/server/src/db/schema.ts
@packages/server/src/index.ts
@packages/client/src/App.tsx
@packages/shared/src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and add shadcn/ui components</name>
  <files>
    packages/server/package.json
    packages/client/package.json
    packages/client/src/components/ui/table.tsx
    packages/client/src/components/ui/dialog.tsx
    packages/client/src/components/ui/form.tsx
    packages/client/src/components/ui/input.tsx
    packages/client/src/components/ui/select.tsx
    packages/client/src/components/ui/label.tsx
    packages/client/src/components/ui/textarea.tsx
  </files>
  <action>
    1. In packages/server, install validation dependencies:
       `bun add @hono/zod-validator drizzle-zod zod`

    2. In packages/client, install routing, table, and form dependencies:
       `bun add @tanstack/react-table react-hook-form @hookform/resolvers zod react-router-dom`

    3. In packages/client, add shadcn/ui components:
       `bunx shadcn@latest add table dialog form input select label textarea`

       Note: If prompted for configuration, use existing settings (New York style, Neutral base).

    4. Verify all components were added to packages/client/src/components/ui/
  </action>
  <verify>
    - `cat packages/server/package.json | grep drizzle-zod` shows the package
    - `cat packages/client/package.json | grep react-router-dom` shows the package
    - `ls packages/client/src/components/ui/` shows table.tsx, dialog.tsx, form.tsx, input.tsx, select.tsx, label.tsx, textarea.tsx
  </verify>
  <done>
    All dependencies installed. shadcn/ui components available in ui folder.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Zod validation schemas and API utilities</name>
  <files>
    packages/server/src/validation/schemas.ts
    packages/client/src/lib/api.ts
  </files>
  <action>
    1. Create packages/server/src/validation/schemas.ts:
       - Use drizzle-zod `createInsertSchema` for each nomenclator table
       - Generate: insertGestiuneSchema, insertLocFolosintaSchema, insertSursaFinantareSchema, insertContSchema
       - Export both insert schemas and inferred types
       - Example:
         ```typescript
         import { createInsertSchema } from "drizzle-zod";
         import { gestiuni, locuriUilizare, surseFinantare, conturi } from "../db/schema";

         export const insertGestiuneSchema = createInsertSchema(gestiuni, {
           cod: (schema) => schema.min(1, "Cod obligatoriu").max(20),
           denumire: (schema) => schema.min(1, "Denumire obligatorie").max(200),
         }).omit({ id: true, createdAt: true, updatedAt: true });

         export type InsertGestiune = typeof insertGestiuneSchema._type;
         ```
       - For each schema, omit auto-generated fields (id, createdAt, updatedAt)
       - Add meaningful validation messages in Romanian

    2. Create packages/client/src/lib/api.ts:
       - Create base fetch wrapper with error handling
       - Use Vite's proxy (already configured in Phase 1) - requests to /api/* go to server
       - Return typed ApiResponse
       - Example:
         ```typescript
         import type { ApiResponse } from "shared";

         const API_BASE = "/api";

         export async function fetchApi<T>(
           endpoint: string,
           options?: RequestInit
         ): Promise<ApiResponse<T>> {
           const res = await fetch(`${API_BASE}${endpoint}`, {
             headers: { "Content-Type": "application/json", ...options?.headers },
             ...options,
           });
           return res.json();
         }

         export const api = {
           get: <T>(endpoint: string) => fetchApi<T>(endpoint),
           post: <T>(endpoint: string, data: unknown) =>
             fetchApi<T>(endpoint, { method: "POST", body: JSON.stringify(data) }),
           put: <T>(endpoint: string, data: unknown) =>
             fetchApi<T>(endpoint, { method: "PUT", body: JSON.stringify(data) }),
           delete: <T>(endpoint: string) =>
             fetchApi<T>(endpoint, { method: "DELETE" }),
         };
         ```
  </action>
  <verify>
    - `bun run --cwd packages/server lint` passes (schemas compile)
    - `bun run --cwd packages/client lint` passes (api.ts compiles)
  </verify>
  <done>
    Zod schemas generated for all nomenclator tables. API client ready for use.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create DataTable component and set up routing</name>
  <files>
    packages/client/src/components/data-table/DataTable.tsx
    packages/client/src/pages/Gestiuni.tsx
    packages/client/src/pages/SurseFinantare.tsx
    packages/client/src/pages/Locuri.tsx
    packages/client/src/pages/Conturi.tsx
    packages/client/src/pages/Clasificari.tsx
    packages/client/src/App.tsx
    packages/client/src/main.tsx
  </files>
  <action>
    1. Create packages/client/src/components/data-table/DataTable.tsx:
       - Generic DataTable using @tanstack/react-table
       - Accept columns and data as props
       - Use shadcn/ui Table components
       - Include basic sorting capability
       - Example structure:
         ```typescript
         import {
           ColumnDef,
           flexRender,
           getCoreRowModel,
           getSortedRowModel,
           SortingState,
           useReactTable,
         } from "@tanstack/react-table";
         import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";

         interface DataTableProps<TData, TValue> {
           columns: ColumnDef<TData, TValue>[];
           data: TData[];
         }

         export function DataTable<TData, TValue>({ columns, data }: DataTableProps<TData, TValue>) {
           const [sorting, setSorting] = useState<SortingState>([]);
           const table = useReactTable({
             data,
             columns,
             getCoreRowModel: getCoreRowModel(),
             getSortedRowModel: getSortedRowModel(),
             onSortingChange: setSorting,
             state: { sorting },
           });
           // Render table...
         }
         ```

    2. Create placeholder page components in packages/client/src/pages/:
       - Gestiuni.tsx: "Gestiuni page - coming soon"
       - SurseFinantare.tsx: "Surse Finantare page - coming soon"
       - Locuri.tsx: "Locuri de Folosinta page - coming soon"
       - Conturi.tsx: "Plan de Conturi page - coming soon"
       - Clasificari.tsx: "Clasificari HG 2139/2004 page - coming soon"
       Each with a simple heading and "coming soon" message.

    3. Update packages/client/src/main.tsx:
       - Set up react-router-dom with createBrowserRouter
       - Define routes: /, /gestiuni, /surse-finantare, /locuri, /conturi, /clasificari
       - Wrap app in RouterProvider

    4. Update packages/client/src/App.tsx:
       - Remove DecimalDemo (it was for Phase 1 verification)
       - Add navigation menu with links to all nomenclator pages
       - Use Outlet from react-router-dom for nested routes
       - Simple layout: nav bar on top, content below
  </action>
  <verify>
    - `bun run --cwd packages/client lint` passes
    - `bun run --cwd packages/client dev` starts without errors
    - Navigate to http://localhost:5173/gestiuni - shows placeholder
    - Navigate to http://localhost:5173/clasificari - shows placeholder
    - All navigation links work
  </verify>
  <done>
    DataTable component created. Routing configured with all nomenclator pages accessible via nav menu.
  </done>
</task>

</tasks>

<verification>
1. All dependencies installed:
   - Server: @hono/zod-validator, drizzle-zod, zod
   - Client: @tanstack/react-table, react-hook-form, @hookform/resolvers, zod, react-router-dom
2. All shadcn/ui components added: table, dialog, form, input, select, label, textarea
3. Zod schemas exist and compile: packages/server/src/validation/schemas.ts
4. API client exists: packages/client/src/lib/api.ts
5. DataTable component exists: packages/client/src/components/data-table/DataTable.tsx
6. Routing works: All 5 nomenclator pages accessible via navigation
7. Both `bun run lint` pass in server and client packages
</verification>

<success_criteria>
- Developer can navigate between nomenclator placeholder pages
- DataTable component is ready for use with any data/columns
- Zod schemas can validate nomenclator data
- API client provides typed GET/POST/PUT/DELETE methods
- All code compiles without TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-nomenclatoare/02-01-SUMMARY.md`
</output>
